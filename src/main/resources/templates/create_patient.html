<!doctype html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>UrinWise</title>
	<link rel="shortcut icon" type="image/png" href="../assets/images/logos/logo1.png" />
	<link rel="stylesheet" href="../assets/css/styles.min.css" />
</head>
<style>
	.custom-container {
		max-width: 2500px;
	}
</style>
<body>
<!--  Body Wrapper -->
<div class="page-wrapper" id="main-wrapper" data-layout="vertical" data-navbarbg="skin6" data-sidebartype="full"
	 data-sidebar-position="fixed" data-header-position="fixed">
	<!-- Sidebar Start -->
	<aside class="left-sidebar">
		<!-- Sidebar scroll-->
		<div>
			<div class="brand-logo d-flex align-items-center justify-content-between">
				<a href="index.html" class="text-nowrap logo-img">
					<img src="../assets/images/logos/&.png" width="180" alt="" />
				</a>
				<div class="close-btn d-xl-none d-block sidebartoggler cursor-pointer" id="sidebarCollapse">
					<i class="ti ti-x fs-8"></i>
				</div>
			</div>
			<!-- Sidebar navigation-->
			<nav class="sidebar-nav scroll-sidebar" data-simplebar="">
				<ul id="sidebarnav">
					<li class="nav-small-cap">
						<i class="ti ti-dots nav-small-cap-icon fs-4"></i>
						<span class="hide-menu">Home</span>
					</li>
					<li class="sidebar-item">
						<a class="sidebar-link" href="index.html" aria-expanded="false">
                <span>
                  <i class="ti ti-layout-dashboard"></i>
                </span>
							<span class="hide-menu">Dashboard</span>
						</a>
					</li>
					<li class="nav-small-cap">
						<i class="ti ti-dots nav-small-cap-icon fs-4"></i>
						<span class="hide-menu">UI COMPONENTS</span>
					</li>
					<li class="sidebar-item">
						<a class="sidebar-link" href="./ui-buttons.html" aria-expanded="false">
                <span>
                  <i class="ti ti-article"></i>
                </span>
							<span class="hide-menu">Patients List</span>
						</a>
					</li>
					<li class="sidebar-item">
						<a class="sidebar-link" href="./ui-alerts.html" aria-expanded="false">
                <span>
                  <i class="ti ti-alert-circle"></i>
                </span>
							<span class="hide-menu">History</span>
						</a>
					</li>

					<li class="nav-small-cap">
						<i class="ti ti-dots nav-small-cap-icon fs-4"></i>
						<span class="hide-menu">AUTH</span>
					</li>
					<li class="sidebar-item">
						<a class="sidebar-link" href="./authentication-login.html" aria-expanded="false">
                <span>
                  <i class="ti ti-login"></i>
                </span>
							<span class="hide-menu">Login</span>
						</a>
					</li>
					<li class="sidebar-item">
						<a class="sidebar-link" href="./authentication-register.html" aria-expanded="false">
                <span>
                  <i class="ti ti-user-plus"></i>
                </span>
							<span class="hide-menu">Register</span>
						</a>
					</li>
				</ul>
			</nav>
			<!-- End Sidebar navigation -->
		</div>
		<!-- End Sidebar scroll-->
	</aside>
	<!--  Sidebar End -->
	<!--  Main wrapper -->
	<div class="body-wrapper">
		<!--  Header Start -->
		<header class="app-header">
			<nav class="navbar navbar-expand-lg navbar-light">
				<ul class="navbar-nav">
					<li class="nav-item d-block d-xl-none">
						<a class="nav-link sidebartoggler nav-icon-hover" id="headerCollapse" href="javascript:void(0)">
							<i class="ti ti-menu-2"></i>
						</a>
					</li>
					<li class="nav-item">
						<a class="nav-link nav-icon-hover" href="javascript:void(0)">
							<i class="ti ti-bell-ringing"></i>
							<div class="notification bg-primary rounded-circle"></div>
						</a>
					</li>
				</ul>
				<div class="navbar-collapse justify-content-end px-0" id="navbarNav">
					<ul class="navbar-nav flex-row ms-auto align-items-center justify-content-end">
						<li class="nav-item dropdown">
							<a class="nav-link nav-icon-hover" href="javascript:void(0)" id="drop2" data-bs-toggle="dropdown"
							   aria-expanded="false">
								<img src="../assets/images/profile/user-1.jpg" alt="" width="35" height="35" class="rounded-circle">
							</a>
							<div class="dropdown-menu dropdown-menu-end dropdown-menu-animate-up" aria-labelledby="drop2">
								<div class="message-body">
									<a href="javascript:void(0)" class="d-flex align-items-center gap-2 dropdown-item">
										<i class="ti ti-user fs-6"></i>
										<p class="mb-0 fs-3">My Profile</p>
									</a>
									<a href="javascript:void(0)" class="d-flex align-items-center gap-2 dropdown-item">
										<i class="ti ti-mail fs-6"></i>
										<p class="mb-0 fs-3">My Account</p>
									</a>
								</div>
							</div>
						</li>
					</ul>
				</div>
			</nav>
		</header>
		<!--  Header End -->
		<div class="container-fluid">
			<!--  Row 1 -->
			<div class="container custom-container">
				<h1 class="text-center text-dark">Create New Patient</h1>
				<div class = "container">
					<div class = "row">
						<div class ="col-lg-6 col-md-6 col-sm-6 container justify-content-center card">

							<div class = "card-body">
								<form th:action="@{/patients}" th:object = "${patient}" method="POST" name="add">

									<div class ="form-group">
										<label>firstName</label>
										<input
												type = "text"
												name = "firstName"
												th:field = "*{firstname}"
												class = "form-control"
												placeholder="Enter patient First Name"
												required/>
									</div>

									<div class ="form-group">
										<label>Last Name </label>
										<input
												type = "text"
												name = "lastName"
												th:field = "*{lastname}"
												class = "form-control"
												placeholder="Enter patient Last Name"
										/>
									</div>

									<div class ="form-group">
										<label> CIN </label>
										<input
												type = "text"
												name = "CIN"
												th:field = "*{CIN}"
												class = "form-control"
												placeholder="Enter patient CIN"
										/>
									</div>

									<div class ="form-group">
										<label> Adresse </label>
										<input
												type = "text"
												name = "adress"
												th:field = "*{adresse}"
												class = "form-control"
												placeholder="Enter patient adresse"
										/>
									</div>

									<div class="form-group">
										<label>Date of Birth</label>
										<input
												type="date"
												name="dateOfBirth"
												th:field="*{dateOfBirth}"
												class="form-control"
										/>
									</div>

									<div class ="form-group">
										<label> tel </label>
										<input
												type = "tel"
												name = "tel"
												th:field = "*{telephone}"
												class = "form-control"
												placeholder="Enter patient tel"
										/>
									</div>

									<div class ="form-group">
										<label> Email </label>
										<input
												type = "email"
												name = "email"
												th:field = "*{email}"
												class = "form-control"
												placeholder="Enter patient Email"
										/>
									</div>

									<div class ="form-group">
										<label> HealthProblem </label>
										<select name="healthProblem" th:field="*{healthProblem}" class="form-control">
											<option th:each="problem : ${T(com.CodeQr.qrCode.HealthProblem).values()}" th:value="${problem}" th:text="${problem}"></option>
										</select>
									</div>

									<div class="form-group">
										<label>Allergy</label>
										<select id="allergy" name="allergy" class="form-control">
											<option value="food">Food Allergies</option><!--Allergies to nuts, shellfish, milk, eggs, soy, wheat, etc.-->
											<option value="drug">Drug Allergies</option><!-- Allergies to antibiotics, painkillers, antihypertensives, etc. -->
											<option value="respiratory">Respiratory Allergies</option><!--Allergies to pollen, dust mites, mold, pet dander, etc -->
											<option value="media">Contrast Media Allergies</option><!--Allergies to contrast agents used in medical imaging like CT scans or MRIs. -->
											<option value="skin">Skin Allergies</option><!--Contact dermatitis due to irritants or allergens in personal care products, clothing, or the environment. -->
											<option value="latex">Latex Allergies</option>
											<option value="">OTHER</option><!-- Allergies to latex found in some medical gloves and devices-->
											<!--This list encompasses common allergens that can affect any individual, including those with urinary prostate issues  -->
										</select>
									</div>

									<div class ="form-group">
										<label> Serial Code </label>
										<input
												type = "text"
												name = "serialCode"
												th:field = "*{serialCode}"
												class = "form-control"
												placeholder="Enter patient serial code"
												readonly />
									</div>

									<div class="row ">
										<div class="offset-sm-4 col-sm-4 d-grid">
											<button type="submit" class = "btn btn-primary">
												Submit
											</button>
										</div>
										<div class="col-sm-4 d-grid">
											<a class="btn btn-outline-primary" href="/patients" role="button">Cancel</a>
										</div>
									</div>

								</form>
							</div>
						</div>
					</div>
				</div>
			</div>
			<script src="/assets/libs/jquery/dist/jquery.min.js"></script>
			<script src="/assets/libs/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
			<script src="/assets/js/sidebarmenu.js"></script>
			<script src="/assets/js/app.min.js"></script>
			<script src="/assets/js/dashboard.js"></script>
			<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
			<script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.19.3/dist/jquery.validate.min.js"></script>
			<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
			<script>
				$.validator.addMethod("uniqueCin", function(value, element) {
					var isValid = false;
					$.ajax({
						url: "/check-cin-exists",
						method: "POST",
						async: false,  // Rendre la requête synchrone
						data: { cin: value },
						success: function(exists) {
							isValid = !exists;
						}
					});
					return isValid;
				}, "This CIN is already in use");
				$("form[name='add']").validate({
					rules: {
						firstName: "required",
						lastName: "required",
						CIN: {
							required: true,
							uniqueCin: true
						},
						telephone: {
							required: true,
							digits: true,
							maxlength: 10
						},
						dateOfBirth: {
							required: true,
							date: true
						},
						email: {
							required: true,
							minlength: 6,
						},
						adresse: {
							required: true,
							minlength: 8,
							maxlength: 20
						}
					},
					messages: {
						firstName: "Please enter the first name",
						lastName: "Please enter the last name",
						CIN: {
							required: "Please enter the CIN"
						},
						telephone: {
							required: "Please enter your phone number",
							digits: "Please enter a valid phone number",
							maxlength: "Phone number cannot exceed 10 digits"
						},
						dateOfBirth: {
							required: "Please enter the date of birth",
							date: "Please enter a valid date"
						},
						email: {
							required: "Please enter the email",
							minlength: "Address must be at least 6 characters long",

						},
						adresse: {
							required: "Please enter the address",
							minlength: "Address must be at least 8 characters long",
							maxlength: "Address cannot exceed 20 characters"
						}
					},
				});
			</script>
		</div>
	</div>
</div>
</body>
</html>